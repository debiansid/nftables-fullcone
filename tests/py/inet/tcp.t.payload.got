# tcp sport vmap { 25 : accept, 28 : drop }
__map%d test-ip4 b
__map%d test-ip4 0
	element 00001900  : 0 [end]	element 00001c00  : 0 [end]
ip test-ip4 input 
  [ payload load 1b @ network header + 9 => reg 1 ]
  [ cmp eq reg 1 0x00000006 ]
  [ payload load 2b @ transport header + 0 => reg 1 ]
  [ lookup reg 1 set __map%d dreg 0 ]

# tcp sport vmap { 25 : accept, 28 : drop }
__map%d test-ip6 b
__map%d test-ip6 0
	element 00001900  : 0 [end]	element 00001c00  : 0 [end]
ip6 test-ip6 input 
  [ payload load 1b @ network header + 6 => reg 1 ]
  [ cmp eq reg 1 0x00000006 ]
  [ payload load 2b @ transport header + 0 => reg 1 ]
  [ lookup reg 1 set __map%d dreg 0 ]

# tcp sport vmap { 25 : accept, 28 : drop }
__map%d test-inet b
__map%d test-inet 0
	element 00001900  : 0 [end]	element 00001c00  : 0 [end]
inet test-inet input 
  [ meta load l4proto => reg 1 ]
  [ cmp eq reg 1 0x00000006 ]
  [ payload load 2b @ transport header + 0 => reg 1 ]
  [ lookup reg 1 set __map%d dreg 0 ]

# tcp sport vmap { 25 : accept, 28 : drop }
__map%d test-netdev b
__map%d test-netdev 0
	element 00001900  : 0 [end]	element 00001c00  : 0 [end]
netdev test-netdev ingress 
  [ meta load l4proto => reg 1 ]
  [ cmp eq reg 1 0x00000006 ]
  [ payload load 2b @ transport header + 0 => reg 1 ]
  [ lookup reg 1 set __map%d dreg 0 ]

# tcp dport != 33-45
ip test-ip4 input 
  [ payload load 1b @ network header + 9 => reg 1 ]
  [ cmp eq reg 1 0x00000006 ]
  [ payload load 2b @ transport header + 2 => reg 1 ]
  [ range neq reg 1 0x00002100 0x00002d00 ]

# tcp dport != 33-45
ip6 test-ip6 input 
  [ payload load 1b @ network header + 6 => reg 1 ]
  [ cmp eq reg 1 0x00000006 ]
  [ payload load 2b @ transport header + 2 => reg 1 ]
  [ range neq reg 1 0x00002100 0x00002d00 ]

# tcp dport != 33-45
inet test-inet input 
  [ meta load l4proto => reg 1 ]
  [ cmp eq reg 1 0x00000006 ]
  [ payload load 2b @ transport header + 2 => reg 1 ]
  [ range neq reg 1 0x00002100 0x00002d00 ]

# tcp dport != 33-45
netdev test-netdev ingress 
  [ meta load l4proto => reg 1 ]
  [ cmp eq reg 1 0x00000006 ]
  [ payload load 2b @ transport header + 2 => reg 1 ]
  [ range neq reg 1 0x00002100 0x00002d00 ]

# tcp sport != 33-45
ip test-ip4 input 
  [ payload load 1b @ network header + 9 => reg 1 ]
  [ cmp eq reg 1 0x00000006 ]
  [ payload load 2b @ transport header + 0 => reg 1 ]
  [ range neq reg 1 0x00002100 0x00002d00 ]

# tcp sport != 33-45
ip6 test-ip6 input 
  [ payload load 1b @ network header + 6 => reg 1 ]
  [ cmp eq reg 1 0x00000006 ]
  [ payload load 2b @ transport header + 0 => reg 1 ]
  [ range neq reg 1 0x00002100 0x00002d00 ]

# tcp sport != 33-45
inet test-inet input 
  [ meta load l4proto => reg 1 ]
  [ cmp eq reg 1 0x00000006 ]
  [ payload load 2b @ transport header + 0 => reg 1 ]
  [ range neq reg 1 0x00002100 0x00002d00 ]

# tcp sport != 33-45
netdev test-netdev ingress 
  [ meta load l4proto => reg 1 ]
  [ cmp eq reg 1 0x00000006 ]
  [ payload load 2b @ transport header + 0 => reg 1 ]
  [ range neq reg 1 0x00002100 0x00002d00 ]

# tcp sequence != 33-45
ip test-ip4 input 
  [ payload load 1b @ network header + 9 => reg 1 ]
  [ cmp eq reg 1 0x00000006 ]
  [ payload load 4b @ transport header + 4 => reg 1 ]
  [ range neq reg 1 0x21000000 0x2d000000 ]

# tcp sequence != 33-45
ip6 test-ip6 input 
  [ payload load 1b @ network header + 6 => reg 1 ]
  [ cmp eq reg 1 0x00000006 ]
  [ payload load 4b @ transport header + 4 => reg 1 ]
  [ range neq reg 1 0x21000000 0x2d000000 ]

# tcp sequence != 33-45
inet test-inet input 
  [ meta load l4proto => reg 1 ]
  [ cmp eq reg 1 0x00000006 ]
  [ payload load 4b @ transport header + 4 => reg 1 ]
  [ range neq reg 1 0x21000000 0x2d000000 ]

# tcp sequence != 33-45
netdev test-netdev ingress 
  [ meta load l4proto => reg 1 ]
  [ cmp eq reg 1 0x00000006 ]
  [ payload load 4b @ transport header + 4 => reg 1 ]
  [ range neq reg 1 0x21000000 0x2d000000 ]

# tcp dport != 33-45
ip test-ip4 input 
  [ payload load 1b @ network header + 9 => reg 1 ]
  [ cmp eq reg 1 0x00000006 ]
  [ payload load 2b @ transport header + 2 => reg 1 ]
  [ range neq reg 1 0x00002100 0x00002d00 ]

# tcp dport != 33-45
ip6 test-ip6 input 
  [ payload load 1b @ network header + 6 => reg 1 ]
  [ cmp eq reg 1 0x00000006 ]
  [ payload load 2b @ transport header + 2 => reg 1 ]
  [ range neq reg 1 0x00002100 0x00002d00 ]

# tcp dport != 33-45
inet test-inet input 
  [ meta load l4proto => reg 1 ]
  [ cmp eq reg 1 0x00000006 ]
  [ payload load 2b @ transport header + 2 => reg 1 ]
  [ range neq reg 1 0x00002100 0x00002d00 ]

# tcp dport != 33-45
netdev test-netdev ingress 
  [ meta load l4proto => reg 1 ]
  [ cmp eq reg 1 0x00000006 ]
  [ payload load 2b @ transport header + 2 => reg 1 ]
  [ range neq reg 1 0x00002100 0x00002d00 ]

# tcp sport != 33-45
ip test-ip4 input 
  [ payload load 1b @ network header + 9 => reg 1 ]
  [ cmp eq reg 1 0x00000006 ]
  [ payload load 2b @ transport header + 0 => reg 1 ]
  [ range neq reg 1 0x00002100 0x00002d00 ]

# tcp sport != 33-45
ip6 test-ip6 input 
  [ payload load 1b @ network header + 6 => reg 1 ]
  [ cmp eq reg 1 0x00000006 ]
  [ payload load 2b @ transport header + 0 => reg 1 ]
  [ range neq reg 1 0x00002100 0x00002d00 ]

# tcp sport != 33-45
inet test-inet input 
  [ meta load l4proto => reg 1 ]
  [ cmp eq reg 1 0x00000006 ]
  [ payload load 2b @ transport header + 0 => reg 1 ]
  [ range neq reg 1 0x00002100 0x00002d00 ]

# tcp sport != 33-45
netdev test-netdev ingress 
  [ meta load l4proto => reg 1 ]
  [ cmp eq reg 1 0x00000006 ]
  [ payload load 2b @ transport header + 0 => reg 1 ]
  [ range neq reg 1 0x00002100 0x00002d00 ]

# tcp sequence != 33-45
ip test-ip4 input 
  [ payload load 1b @ network header + 9 => reg 1 ]
  [ cmp eq reg 1 0x00000006 ]
  [ payload load 4b @ transport header + 4 => reg 1 ]
  [ range neq reg 1 0x21000000 0x2d000000 ]

# tcp sequence != 33-45
ip6 test-ip6 input 
  [ payload load 1b @ network header + 6 => reg 1 ]
  [ cmp eq reg 1 0x00000006 ]
  [ payload load 4b @ transport header + 4 => reg 1 ]
  [ range neq reg 1 0x21000000 0x2d000000 ]

# tcp sequence != 33-45
inet test-inet input 
  [ meta load l4proto => reg 1 ]
  [ cmp eq reg 1 0x00000006 ]
  [ payload load 4b @ transport header + 4 => reg 1 ]
  [ range neq reg 1 0x21000000 0x2d000000 ]

# tcp sequence != 33-45
netdev test-netdev ingress 
  [ meta load l4proto => reg 1 ]
  [ cmp eq reg 1 0x00000006 ]
  [ payload load 4b @ transport header + 4 => reg 1 ]
  [ range neq reg 1 0x21000000 0x2d000000 ]

# tcp ackseq != 33-45
ip test-ip4 input 
  [ payload load 1b @ network header + 9 => reg 1 ]
  [ cmp eq reg 1 0x00000006 ]
  [ payload load 4b @ transport header + 8 => reg 1 ]
  [ range neq reg 1 0x21000000 0x2d000000 ]

# tcp ackseq != 33-45
ip6 test-ip6 input 
  [ payload load 1b @ network header + 6 => reg 1 ]
  [ cmp eq reg 1 0x00000006 ]
  [ payload load 4b @ transport header + 8 => reg 1 ]
  [ range neq reg 1 0x21000000 0x2d000000 ]

# tcp ackseq != 33-45
inet test-inet input 
  [ meta load l4proto => reg 1 ]
  [ cmp eq reg 1 0x00000006 ]
  [ payload load 4b @ transport header + 8 => reg 1 ]
  [ range neq reg 1 0x21000000 0x2d000000 ]

# tcp ackseq != 33-45
netdev test-netdev ingress 
  [ meta load l4proto => reg 1 ]
  [ cmp eq reg 1 0x00000006 ]
  [ payload load 4b @ transport header + 8 => reg 1 ]
  [ range neq reg 1 0x21000000 0x2d000000 ]

# tcp window != 33-45
ip test-ip4 input 
  [ payload load 1b @ network header + 9 => reg 1 ]
  [ cmp eq reg 1 0x00000006 ]
  [ payload load 2b @ transport header + 14 => reg 1 ]
  [ range neq reg 1 0x00002100 0x00002d00 ]

# tcp window != 33-45
ip6 test-ip6 input 
  [ payload load 1b @ network header + 6 => reg 1 ]
  [ cmp eq reg 1 0x00000006 ]
  [ payload load 2b @ transport header + 14 => reg 1 ]
  [ range neq reg 1 0x00002100 0x00002d00 ]

# tcp window != 33-45
inet test-inet input 
  [ meta load l4proto => reg 1 ]
  [ cmp eq reg 1 0x00000006 ]
  [ payload load 2b @ transport header + 14 => reg 1 ]
  [ range neq reg 1 0x00002100 0x00002d00 ]

# tcp window != 33-45
netdev test-netdev ingress 
  [ meta load l4proto => reg 1 ]
  [ cmp eq reg 1 0x00000006 ]
  [ payload load 2b @ transport header + 14 => reg 1 ]
  [ range neq reg 1 0x00002100 0x00002d00 ]

# tcp checksum != 33-45
ip test-ip4 input 
  [ payload load 1b @ network header + 9 => reg 1 ]
  [ cmp eq reg 1 0x00000006 ]
  [ payload load 2b @ transport header + 16 => reg 1 ]
  [ range neq reg 1 0x00002100 0x00002d00 ]

# tcp checksum != 33-45
ip6 test-ip6 input 
  [ payload load 1b @ network header + 6 => reg 1 ]
  [ cmp eq reg 1 0x00000006 ]
  [ payload load 2b @ transport header + 16 => reg 1 ]
  [ range neq reg 1 0x00002100 0x00002d00 ]

# tcp checksum != 33-45
inet test-inet input 
  [ meta load l4proto => reg 1 ]
  [ cmp eq reg 1 0x00000006 ]
  [ payload load 2b @ transport header + 16 => reg 1 ]
  [ range neq reg 1 0x00002100 0x00002d00 ]

# tcp checksum != 33-45
netdev test-netdev ingress 
  [ meta load l4proto => reg 1 ]
  [ cmp eq reg 1 0x00000006 ]
  [ payload load 2b @ transport header + 16 => reg 1 ]
  [ range neq reg 1 0x00002100 0x00002d00 ]

# tcp urgptr != 33-45
ip test-ip4 input 
  [ payload load 1b @ network header + 9 => reg 1 ]
  [ cmp eq reg 1 0x00000006 ]
  [ payload load 2b @ transport header + 18 => reg 1 ]
  [ range neq reg 1 0x00002100 0x00002d00 ]

# tcp urgptr != 33-45
ip6 test-ip6 input 
  [ payload load 1b @ network header + 6 => reg 1 ]
  [ cmp eq reg 1 0x00000006 ]
  [ payload load 2b @ transport header + 18 => reg 1 ]
  [ range neq reg 1 0x00002100 0x00002d00 ]

# tcp urgptr != 33-45
inet test-inet input 
  [ meta load l4proto => reg 1 ]
  [ cmp eq reg 1 0x00000006 ]
  [ payload load 2b @ transport header + 18 => reg 1 ]
  [ range neq reg 1 0x00002100 0x00002d00 ]

# tcp urgptr != 33-45
netdev test-netdev ingress 
  [ meta load l4proto => reg 1 ]
  [ cmp eq reg 1 0x00000006 ]
  [ payload load 2b @ transport header + 18 => reg 1 ]
  [ range neq reg 1 0x00002100 0x00002d00 ]

# tcp dport != 33-45
ip test-ip4 input 
  [ payload load 1b @ network header + 9 => reg 1 ]
  [ cmp eq reg 1 0x00000006 ]
  [ payload load 2b @ transport header + 2 => reg 1 ]
  [ range neq reg 1 0x00002100 0x00002d00 ]

# tcp dport != 33-45
ip6 test-ip6 input 
  [ payload load 1b @ network header + 6 => reg 1 ]
  [ cmp eq reg 1 0x00000006 ]
  [ payload load 2b @ transport header + 2 => reg 1 ]
  [ range neq reg 1 0x00002100 0x00002d00 ]

# tcp dport != 33-45
inet test-inet input 
  [ meta load l4proto => reg 1 ]
  [ cmp eq reg 1 0x00000006 ]
  [ payload load 2b @ transport header + 2 => reg 1 ]
  [ range neq reg 1 0x00002100 0x00002d00 ]

# tcp dport != 33-45
netdev test-netdev ingress 
  [ meta load l4proto => reg 1 ]
  [ cmp eq reg 1 0x00000006 ]
  [ payload load 2b @ transport header + 2 => reg 1 ]
  [ range neq reg 1 0x00002100 0x00002d00 ]

# tcp sport != 33-45
ip test-ip4 input 
  [ payload load 1b @ network header + 9 => reg 1 ]
  [ cmp eq reg 1 0x00000006 ]
  [ payload load 2b @ transport header + 0 => reg 1 ]
  [ range neq reg 1 0x00002100 0x00002d00 ]

# tcp sport != 33-45
ip6 test-ip6 input 
  [ payload load 1b @ network header + 6 => reg 1 ]
  [ cmp eq reg 1 0x00000006 ]
  [ payload load 2b @ transport header + 0 => reg 1 ]
  [ range neq reg 1 0x00002100 0x00002d00 ]

# tcp sport != 33-45
inet test-inet input 
  [ meta load l4proto => reg 1 ]
  [ cmp eq reg 1 0x00000006 ]
  [ payload load 2b @ transport header + 0 => reg 1 ]
  [ range neq reg 1 0x00002100 0x00002d00 ]

# tcp sport != 33-45
netdev test-netdev ingress 
  [ meta load l4proto => reg 1 ]
  [ cmp eq reg 1 0x00000006 ]
  [ payload load 2b @ transport header + 0 => reg 1 ]
  [ range neq reg 1 0x00002100 0x00002d00 ]

# tcp sequence != 33-45
ip test-ip4 input 
  [ payload load 1b @ network header + 9 => reg 1 ]
  [ cmp eq reg 1 0x00000006 ]
  [ payload load 4b @ transport header + 4 => reg 1 ]
  [ range neq reg 1 0x21000000 0x2d000000 ]

# tcp sequence != 33-45
ip6 test-ip6 input 
  [ payload load 1b @ network header + 6 => reg 1 ]
  [ cmp eq reg 1 0x00000006 ]
  [ payload load 4b @ transport header + 4 => reg 1 ]
  [ range neq reg 1 0x21000000 0x2d000000 ]

# tcp sequence != 33-45
inet test-inet input 
  [ meta load l4proto => reg 1 ]
  [ cmp eq reg 1 0x00000006 ]
  [ payload load 4b @ transport header + 4 => reg 1 ]
  [ range neq reg 1 0x21000000 0x2d000000 ]

# tcp sequence != 33-45
netdev test-netdev ingress 
  [ meta load l4proto => reg 1 ]
  [ cmp eq reg 1 0x00000006 ]
  [ payload load 4b @ transport header + 4 => reg 1 ]
  [ range neq reg 1 0x21000000 0x2d000000 ]

# tcp ackseq != 33-45
ip test-ip4 input 
  [ payload load 1b @ network header + 9 => reg 1 ]
  [ cmp eq reg 1 0x00000006 ]
  [ payload load 4b @ transport header + 8 => reg 1 ]
  [ range neq reg 1 0x21000000 0x2d000000 ]

# tcp ackseq != 33-45
ip6 test-ip6 input 
  [ payload load 1b @ network header + 6 => reg 1 ]
  [ cmp eq reg 1 0x00000006 ]
  [ payload load 4b @ transport header + 8 => reg 1 ]
  [ range neq reg 1 0x21000000 0x2d000000 ]

# tcp ackseq != 33-45
inet test-inet input 
  [ meta load l4proto => reg 1 ]
  [ cmp eq reg 1 0x00000006 ]
  [ payload load 4b @ transport header + 8 => reg 1 ]
  [ range neq reg 1 0x21000000 0x2d000000 ]

# tcp ackseq != 33-45
netdev test-netdev ingress 
  [ meta load l4proto => reg 1 ]
  [ cmp eq reg 1 0x00000006 ]
  [ payload load 4b @ transport header + 8 => reg 1 ]
  [ range neq reg 1 0x21000000 0x2d000000 ]

# tcp window != 33-45
ip test-ip4 input 
  [ payload load 1b @ network header + 9 => reg 1 ]
  [ cmp eq reg 1 0x00000006 ]
  [ payload load 2b @ transport header + 14 => reg 1 ]
  [ range neq reg 1 0x00002100 0x00002d00 ]

# tcp window != 33-45
ip6 test-ip6 input 
  [ payload load 1b @ network header + 6 => reg 1 ]
  [ cmp eq reg 1 0x00000006 ]
  [ payload load 2b @ transport header + 14 => reg 1 ]
  [ range neq reg 1 0x00002100 0x00002d00 ]

# tcp window != 33-45
inet test-inet input 
  [ meta load l4proto => reg 1 ]
  [ cmp eq reg 1 0x00000006 ]
  [ payload load 2b @ transport header + 14 => reg 1 ]
  [ range neq reg 1 0x00002100 0x00002d00 ]

# tcp window != 33-45
netdev test-netdev ingress 
  [ meta load l4proto => reg 1 ]
  [ cmp eq reg 1 0x00000006 ]
  [ payload load 2b @ transport header + 14 => reg 1 ]
  [ range neq reg 1 0x00002100 0x00002d00 ]

# tcp checksum != 33-45
ip test-ip4 input 
  [ payload load 1b @ network header + 9 => reg 1 ]
  [ cmp eq reg 1 0x00000006 ]
  [ payload load 2b @ transport header + 16 => reg 1 ]
  [ range neq reg 1 0x00002100 0x00002d00 ]

# tcp checksum != 33-45
ip6 test-ip6 input 
  [ payload load 1b @ network header + 6 => reg 1 ]
  [ cmp eq reg 1 0x00000006 ]
  [ payload load 2b @ transport header + 16 => reg 1 ]
  [ range neq reg 1 0x00002100 0x00002d00 ]

# tcp checksum != 33-45
inet test-inet input 
  [ meta load l4proto => reg 1 ]
  [ cmp eq reg 1 0x00000006 ]
  [ payload load 2b @ transport header + 16 => reg 1 ]
  [ range neq reg 1 0x00002100 0x00002d00 ]

# tcp checksum != 33-45
netdev test-netdev ingress 
  [ meta load l4proto => reg 1 ]
  [ cmp eq reg 1 0x00000006 ]
  [ payload load 2b @ transport header + 16 => reg 1 ]
  [ range neq reg 1 0x00002100 0x00002d00 ]

# tcp urgptr != 33-45
ip test-ip4 input 
  [ payload load 1b @ network header + 9 => reg 1 ]
  [ cmp eq reg 1 0x00000006 ]
  [ payload load 2b @ transport header + 18 => reg 1 ]
  [ range neq reg 1 0x00002100 0x00002d00 ]

# tcp urgptr != 33-45
ip6 test-ip6 input 
  [ payload load 1b @ network header + 6 => reg 1 ]
  [ cmp eq reg 1 0x00000006 ]
  [ payload load 2b @ transport header + 18 => reg 1 ]
  [ range neq reg 1 0x00002100 0x00002d00 ]

# tcp urgptr != 33-45
inet test-inet input 
  [ meta load l4proto => reg 1 ]
  [ cmp eq reg 1 0x00000006 ]
  [ payload load 2b @ transport header + 18 => reg 1 ]
  [ range neq reg 1 0x00002100 0x00002d00 ]

# tcp urgptr != 33-45
netdev test-netdev ingress 
  [ meta load l4proto => reg 1 ]
  [ cmp eq reg 1 0x00000006 ]
  [ payload load 2b @ transport header + 18 => reg 1 ]
  [ range neq reg 1 0x00002100 0x00002d00 ]

# tcp sport 33-45
ip6 test-ip6 input 
  [ payload load 1b @ network header + 6 => reg 1 ]
  [ cmp eq reg 1 0x00000006 ]
  [ payload load 2b @ transport header + 0 => reg 1 ]
  [ cmp gte reg 1 0x00002100 ]
  [ cmp lte reg 1 0x00002d00 ]

# tcp sport 33-45
ip6 test-ip6 input 
  [ payload load 1b @ network header + 6 => reg 1 ]
  [ cmp eq reg 1 0x00000006 ]
  [ payload load 2b @ transport header + 0 => reg 1 ]
  [ cmp gte reg 1 0x00002100 ]
  [ cmp lte reg 1 0x00002d00 ]

