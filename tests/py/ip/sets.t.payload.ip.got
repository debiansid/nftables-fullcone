# ip saddr @set6 drop
ip
  [ payload load 4b @ network header + 12 => reg 1 ]
  [ lookup reg 1 set set6 ]
  [ immediate reg 0 drop ]

# ip saddr vmap { 1.1.1.1 : drop, * : accept }
__map%d test-ip4 b
__map%d test-ip4 0
	element 01010101  : drop 0 [end]	element  : accept 2 [end]
ip
  [ payload load 4b @ network header + 12 => reg 1 ]
  [ lookup reg 1 set __map%d dreg 0 ]

# meta mark set ip saddr map { 1.1.1.1 : 0x1, * : 0x2 }
__map%d test-ip4 b
__map%d test-ip4 0
	element 01010101  : 00000001 0 [end]	element  : 00000002 2 [end]
ip
  [ payload load 4b @ network header + 12 => reg 1 ]
  [ lookup reg 1 set __map%d dreg 1 ]
  [ meta set mark with reg 1 ]

# meta mark set ip saddr map { 1.1.1.1 : 0x00000001, * : 0x00000002 }
__map%d test-ip4 b
__map%d test-ip4 0
	element 01010101  : 00000001 0 [end]	element  : 00000002 2 [end]
ip
  [ payload load 4b @ network header + 12 => reg 1 ]
  [ lookup reg 1 set __map%d dreg 1 ]
  [ meta set mark with reg 1 ]

