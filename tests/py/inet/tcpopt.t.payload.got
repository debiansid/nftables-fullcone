# tcp option eol kind 1
inet test-inet input 
  [ meta load l4proto => reg 1 ]
  [ cmp eq reg 1 0x00000006 ]
  [ exthdr load tcpopt 1b @ 1 + 0 => reg 1 ]
  [ cmp eq reg 1 0x00000001 ]

# tcp option maxseg kind 1
inet test-inet input 
  [ meta load l4proto => reg 1 ]
  [ cmp eq reg 1 0x00000006 ]
  [ exthdr load tcpopt 1b @ 3 + 0 => reg 1 ]
  [ cmp eq reg 1 0x00000001 ]

# tcp option maxseg length 1
inet test-inet input 
  [ meta load l4proto => reg 1 ]
  [ cmp eq reg 1 0x00000006 ]
  [ exthdr load tcpopt 1b @ 3 + 1 => reg 1 ]
  [ cmp eq reg 1 0x00000001 ]

# tcp option window kind 1
inet test-inet input 
  [ meta load l4proto => reg 1 ]
  [ cmp eq reg 1 0x00000006 ]
  [ exthdr load tcpopt 1b @ 4 + 0 => reg 1 ]
  [ cmp eq reg 1 0x00000001 ]

# tcp option window length 1
inet test-inet input 
  [ meta load l4proto => reg 1 ]
  [ cmp eq reg 1 0x00000006 ]
  [ exthdr load tcpopt 1b @ 4 + 1 => reg 1 ]
  [ cmp eq reg 1 0x00000001 ]

# tcp option sack1 left 1
inet test-inet input 
  [ meta load l4proto => reg 1 ]
  [ cmp eq reg 1 0x00000006 ]
  [ exthdr load tcpopt 4b @ 5 + 2 => reg 1 ]
  [ cmp eq reg 1 0x01000000 ]

# tcp option sack2 left 1
inet test-inet input 
  [ meta load l4proto => reg 1 ]
  [ cmp eq reg 1 0x00000006 ]
  [ exthdr load tcpopt 4b @ 5 + 2 => reg 1 ]
  [ cmp eq reg 1 0x01000000 ]

# tcp option sack3 left 1
inet test-inet input 
  [ meta load l4proto => reg 1 ]
  [ cmp eq reg 1 0x00000006 ]
  [ exthdr load tcpopt 4b @ 5 + 2 => reg 1 ]
  [ cmp eq reg 1 0x01000000 ]

# tcp option sack1 right 1
inet test-inet input 
  [ meta load l4proto => reg 1 ]
  [ cmp eq reg 1 0x00000006 ]
  [ exthdr load tcpopt 4b @ 5 + 6 => reg 1 ]
  [ cmp eq reg 1 0x01000000 ]

# tcp option sack2 right 1
inet test-inet input 
  [ meta load l4proto => reg 1 ]
  [ cmp eq reg 1 0x00000006 ]
  [ exthdr load tcpopt 4b @ 5 + 6 => reg 1 ]
  [ cmp eq reg 1 0x01000000 ]

# tcp option sack3 right 1
inet test-inet input 
  [ meta load l4proto => reg 1 ]
  [ cmp eq reg 1 0x00000006 ]
  [ exthdr load tcpopt 4b @ 5 + 6 => reg 1 ]
  [ cmp eq reg 1 0x01000000 ]

# tcp option sack1 right 1
inet test-inet input 
  [ meta load l4proto => reg 1 ]
  [ cmp eq reg 1 0x00000006 ]
  [ exthdr load tcpopt 4b @ 5 + 14 => reg 1 ]
  [ cmp eq reg 1 0x01000000 ]

# tcp option sack1 right 1
inet test-inet input 
  [ meta load l4proto => reg 1 ]
  [ cmp eq reg 1 0x00000006 ]
  [ exthdr load tcpopt 4b @ 5 + 14 => reg 1 ]
  [ cmp eq reg 1 0x01000000 ]

# tcp option sack1 right 1
inet test-inet input 
  [ meta load l4proto => reg 1 ]
  [ cmp eq reg 1 0x00000006 ]
  [ exthdr load tcpopt 4b @ 5 + 14 => reg 1 ]
  [ cmp eq reg 1 0x01000000 ]

# tcp option sack kind 1
inet test-inet input 
  [ meta load l4proto => reg 1 ]
  [ cmp eq reg 1 0x00000006 ]
  [ exthdr load tcpopt 1b @ 5 + 0 => reg 1 ]
  [ cmp eq reg 1 0x00000001 ]

# tcp option sack length 1
inet test-inet input 
  [ meta load l4proto => reg 1 ]
  [ cmp eq reg 1 0x00000006 ]
  [ exthdr load tcpopt 1b @ 5 + 1 => reg 1 ]
  [ cmp eq reg 1 0x00000001 ]

# tcp option sack left 1
inet test-inet input 
  [ meta load l4proto => reg 1 ]
  [ cmp eq reg 1 0x00000006 ]
  [ exthdr load tcpopt 4b @ 5 + 2 => reg 1 ]
  [ cmp eq reg 1 0x01000000 ]

# tcp option sack1 right 1
inet test-inet input 
  [ meta load l4proto => reg 1 ]
  [ cmp eq reg 1 0x00000006 ]
  [ exthdr load tcpopt 4b @ 5 + 14 => reg 1 ]
  [ cmp eq reg 1 0x01000000 ]

# tcp option sack0 left 1
inet test-inet input 
  [ meta load l4proto => reg 1 ]
  [ cmp eq reg 1 0x00000006 ]
  [ exthdr load tcpopt 4b @ 5 + 2 => reg 1 ]
  [ cmp eq reg 1 0x01000000 ]

# tcp option sack0 right 1
inet test-inet input 
  [ meta load l4proto => reg 1 ]
  [ cmp eq reg 1 0x00000006 ]
  [ exthdr load tcpopt 4b @ 5 + 6 => reg 1 ]
  [ cmp eq reg 1 0x01000000 ]

# tcp option sack1 right 1
inet test-inet input 
  [ meta load l4proto => reg 1 ]
  [ cmp eq reg 1 0x00000006 ]
  [ exthdr load tcpopt 4b @ 5 + 14 => reg 1 ]
  [ cmp eq reg 1 0x01000000 ]

# tcp option sack0 left 1
inet test-inet input 
  [ meta load l4proto => reg 1 ]
  [ cmp eq reg 1 0x00000006 ]
  [ exthdr load tcpopt 4b @ 5 + 2 => reg 1 ]
  [ cmp eq reg 1 0x01000000 ]

# tcp option sack0 right 1
inet test-inet input 
  [ meta load l4proto => reg 1 ]
  [ cmp eq reg 1 0x00000006 ]
  [ exthdr load tcpopt 4b @ 5 + 6 => reg 1 ]
  [ cmp eq reg 1 0x01000000 ]

# tcp option sack1 right 1
inet test-inet input 
  [ meta load l4proto => reg 1 ]
  [ cmp eq reg 1 0x00000006 ]
  [ exthdr load tcpopt 4b @ 5 + 14 => reg 1 ]
  [ cmp eq reg 1 0x01000000 ]

# tcp option sack0 left 1
inet test-inet input 
  [ meta load l4proto => reg 1 ]
  [ cmp eq reg 1 0x00000006 ]
  [ exthdr load tcpopt 4b @ 5 + 2 => reg 1 ]
  [ cmp eq reg 1 0x01000000 ]

# tcp option sack0 right 1
inet test-inet input 
  [ meta load l4proto => reg 1 ]
  [ cmp eq reg 1 0x00000006 ]
  [ exthdr load tcpopt 4b @ 5 + 6 => reg 1 ]
  [ cmp eq reg 1 0x01000000 ]

# tcp option sack1 right 1
inet test-inet input 
  [ meta load l4proto => reg 1 ]
  [ cmp eq reg 1 0x00000006 ]
  [ exthdr load tcpopt 4b @ 5 + 14 => reg 1 ]
  [ cmp eq reg 1 0x01000000 ]

# tcp option sack0 right 1
inet test-inet input 
  [ meta load l4proto => reg 1 ]
  [ cmp eq reg 1 0x00000006 ]
  [ exthdr load tcpopt 4b @ 5 + 6 => reg 1 ]
  [ cmp eq reg 1 0x01000000 ]

# tcp option sack1 right 1
inet test-inet input 
  [ meta load l4proto => reg 1 ]
  [ cmp eq reg 1 0x00000006 ]
  [ exthdr load tcpopt 4b @ 5 + 14 => reg 1 ]
  [ cmp eq reg 1 0x01000000 ]

# tcp option sack0 right 1
inet test-inet input 
  [ meta load l4proto => reg 1 ]
  [ cmp eq reg 1 0x00000006 ]
  [ exthdr load tcpopt 4b @ 5 + 6 => reg 1 ]
  [ cmp eq reg 1 0x01000000 ]

